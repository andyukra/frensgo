import{m as ae,s as A,r as Me}from"../chunks/index.CZ-a_-fN.js";import{s as ne,y as me,n as Q,c as le,r as ye,o as Oe,d as P,f as we}from"../chunks/scheduler.Hg06gspx.js";import{S as re,i as oe,e as b,s as w,t as q,c as E,a as U,d as _,f as L,b as G,n as f,g as Z,h as i,j as x,y as ce,z as ie,m as ve,A as ue,o as ge,p as _e,q as Le,k as N,u as pe,l as D,B as fe,C as be,w as Ee}from"../chunks/index.D1W0QcSA.js";import{N as Ne}from"../chunks/Navbar.Cfb8haCG.js";import"../chunks/entry.BG9LFflI.js";function K(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function ke(){let l,t;if(ae.subscribe(s=>l=s),A.subscribe(s=>t=s),!l||!t)throw Me(307,"/")}const Fe=Object.freeze(Object.defineProperty({__proto__:null,load:ke},Symbol.toStringTag,{value:"Module"}));function Be(l){let t,s,e,o,n,j=decodeURI(l[0].username)+"",I,d,p,h,T=l[0].body+"",S,y;return{c(){t=b("article"),s=b("div"),e=b("i"),o=w(),n=b("h4"),I=q(j),d=w(),p=b("div"),h=b("p"),S=q(T),this.h()},l(c){t=E(c,"ARTICLE",{class:!0});var g=U(t);s=E(g,"DIV",{class:!0});var R=U(s);e=E(R,"I",{class:!0}),U(e).forEach(_),o=L(R),n=E(R,"H4",{class:!0});var M=U(n);I=G(M,j),M.forEach(_),R.forEach(_),d=L(g),p=E(g,"DIV",{class:!0});var O=U(p);h=E(O,"P",{class:!0});var V=U(h);S=G(V,T),V.forEach(_),O.forEach(_),g.forEach(_),this.h()},h(){f(e,"class","fa-solid fa-circle-user svelte-134al0i"),f(n,"class","montserrat-alternates-bold svelte-134al0i"),f(s,"class","username svelte-134al0i"),f(h,"class","montserrat-alternates-regular"),f(p,"class","body svelte-134al0i"),f(t,"class",y=me(l[1].username===decodeURI(l[0].username)?"me":"")+" svelte-134al0i")},m(c,g){Z(c,t,g),i(t,s),i(s,e),i(s,o),i(s,n),i(n,I),i(t,d),i(t,p),i(p,h),i(h,S)},p(c,[g]){g&1&&j!==(j=decodeURI(c[0].username)+"")&&x(I,j),g&1&&T!==(T=c[0].body+"")&&x(S,T),g&3&&y!==(y=me(c[1].username===decodeURI(c[0].username)?"me":"")+" svelte-134al0i")&&f(t,"class",y)},i:Q,o:Q,d(c){c&&_(t)}}}function Ce(l,t,s){let e;le(l,ae,n=>s(1,e=n));let{data:o}=t;return l.$$set=n=>{"data"in n&&s(0,o=n.data)},[o,e]}class He extends re{constructor(t){super(),oe(this,t,Ce,Be,ne,{data:0})}}function $e(l){let t,s,e,o,n=decodeURI(l[1].username)+"",j,I,d;return{c(){t=b("article"),s=b("i"),e=w(),o=b("h4"),j=q(n),I=w(),d=b("i"),this.h()},l(p){t=E(p,"ARTICLE",{"data-id":!0,class:!0});var h=U(t);s=E(h,"I",{class:!0}),U(s).forEach(_),e=L(h),o=E(h,"H4",{class:!0});var T=U(o);j=G(T,n),T.forEach(_),I=L(h),d=E(h,"I",{class:!0}),U(d).forEach(_),h.forEach(_),this.h()},h(){f(s,"class","fa-solid fa-circle-user svelte-vv2xs7"),f(o,"class","montserrat-alternates-bold svelte-vv2xs7"),f(d,"class","fa-solid fa-circle-question svelte-vv2xs7"),f(t,"data-id",l[0]),f(t,"class","svelte-vv2xs7")},m(p,h){Z(p,t,h),i(t,s),i(t,e),i(t,o),i(o,j),i(t,I),i(t,d)},p(p,[h]){h&2&&n!==(n=decodeURI(p[1].username)+"")&&x(j,n),h&1&&f(t,"data-id",p[0])},i:Q,o:Q,d(p){p&&_(t)}}}function Ae(l,t,s){let{id:e}=t,{data:o}=t;return l.$$set=n=>{"id"in n&&s(0,e=n.id),"data"in n&&s(1,o=n.data)},[e,o]}class De extends re{constructor(t){super(),oe(this,t,Ae,$e,ne,{id:0,data:1})}}function Ie(l,t,s){const e=l.slice();return e[11]=t[s][0],e[12]=t[s][1],e}function Te(l,t,s){const e=l.slice();return e[15]=t[s],e}function je(l){let t,s;return t=new He({props:{data:l[15]}}),{c(){ce(t.$$.fragment)},l(e){ie(t.$$.fragment,e)},m(e,o){ue(t,e,o),s=!0},p(e,o){const n={};o&8&&(n.data=e[15]),t.$set(n)},i(e){s||(N(t.$$.fragment,e),s=!0)},o(e){D(t.$$.fragment,e),s=!1},d(e){fe(t,e)}}}function Se(l){let t,s;return t=new De({props:{id:l[11],data:l[12]}}),{c(){ce(t.$$.fragment)},l(e){ie(t.$$.fragment,e)},m(e,o){ue(t,e,o),s=!0},p(e,o){const n={};o&4&&(n.id=e[11]),o&4&&(n.data=e[12]),t.$set(n)},i(e){s||(N(t.$$.fragment,e),s=!0)},o(e){D(t.$$.fragment,e),s=!1},d(e){fe(t,e)}}}function Ve(l){let t,s,e,o,n,j,I,d,p='<div class="txtStyle svelte-ghgvcj"><button class="montserrat-alternates-regular activeStyle svelte-ghgvcj">T</button> <button class="montserrat-alternates-medium svelte-ghgvcj">T</button> <button class="montserrat-alternates-bold svelte-ghgvcj">T</button></div>',h,T,S,y,c,g='<i class="fa-solid fa-paper-plane svelte-ghgvcj"></i>',R,M,O,V,z=l[2].size+"",W,ee,B,J,te,he;t=new Ne({});let C=K(l[3]),m=[];for(let a=0;a<C.length;a+=1)m[a]=je(Te(l,C,a));const Ue=a=>D(m[a],1,1,()=>{m[a]=null});let H=K(l[2].entries()),v=[];for(let a=0;a<H.length;a+=1)v[a]=Se(Ie(l,H,a));const Re=a=>D(v[a],1,1,()=>{v[a]=null});return{c(){ce(t.$$.fragment),s=w(),e=b("section"),o=b("article"),n=b("div");for(let a=0;a<m.length;a+=1)m[a].c();j=w(),I=b("div"),d=b("div"),d.innerHTML=p,h=w(),T=b("form"),S=b("input"),y=w(),c=b("button"),c.innerHTML=g,R=w(),M=b("article"),O=b("h3"),V=q("Usuarios conectados: "),W=q(z),ee=w(),B=b("div");for(let a=0;a<v.length;a+=1)v[a].c();this.h()},l(a){ie(t.$$.fragment,a),s=L(a),e=E(a,"SECTION",{class:!0});var u=U(e);o=E(u,"ARTICLE",{class:!0});var r=U(o);n=E(r,"DIV",{class:!0});var k=U(n);for(let $=0;$<m.length;$+=1)m[$].l(k);k.forEach(_),j=L(r),I=E(r,"DIV",{class:!0});var X=U(I);d=E(X,"DIV",{class:!0,"data-svelte-h":!0}),ve(d)!=="svelte-1vhb3g2"&&(d.innerHTML=p),h=L(X),T=E(X,"FORM",{class:!0});var F=U(T);S=E(F,"INPUT",{class:!0,type:!0,placeholder:!0,maxlength:!0,minlength:!0}),y=L(F),c=E(F,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(c)!=="svelte-1m1u804"&&(c.innerHTML=g),F.forEach(_),X.forEach(_),r.forEach(_),R=L(u),M=E(u,"ARTICLE",{class:!0});var Y=U(M);O=E(Y,"H3",{class:!0});var se=U(O);V=G(se,"Usuarios conectados: "),W=G(se,z),se.forEach(_),ee=L(Y),B=E(Y,"DIV",{class:!0});var de=U(B);for(let $=0;$<v.length;$+=1)v[$].l(de);de.forEach(_),Y.forEach(_),u.forEach(_),this.h()},h(){f(n,"class","chat svelte-ghgvcj"),f(d,"class","tools svelte-ghgvcj"),f(S,"class","montserrat-alternates-regular svelte-ghgvcj"),f(S,"type","text"),f(S,"placeholder","Escribe tu mensaje..."),f(S,"maxlength","120"),f(S,"minlength","1"),f(c,"class","svelte-ghgvcj"),f(T,"class","svelte-ghgvcj"),f(I,"class","msg svelte-ghgvcj"),f(o,"class","chatBX svelte-ghgvcj"),f(O,"class","montserrat-alternates-bold svelte-ghgvcj"),f(B,"class","userlist svelte-ghgvcj"),f(M,"class","users svelte-ghgvcj"),f(e,"class","svelte-ghgvcj")},m(a,u){ue(t,a,u),Z(a,s,u),Z(a,e,u),i(e,o),i(o,n);for(let r=0;r<m.length;r+=1)m[r]&&m[r].m(n,null);l[5](n),i(o,j),i(o,I),i(I,d),i(I,h),i(I,T),i(T,S),ge(S,l[0]),i(T,y),i(T,c),i(e,R),i(e,M),i(M,O),i(O,V),i(O,W),i(M,ee),i(M,B);for(let r=0;r<v.length;r+=1)v[r]&&v[r].m(B,null);J=!0,te||(he=[_e(S,"input",l[6]),_e(T,"submit",Le(l[4]))],te=!0)},p(a,[u]){if(u&8){C=K(a[3]);let r;for(r=0;r<C.length;r+=1){const k=Te(a,C,r);m[r]?(m[r].p(k,u),N(m[r],1)):(m[r]=je(k),m[r].c(),N(m[r],1),m[r].m(n,null))}for(Ee(),r=C.length;r<m.length;r+=1)Ue(r);pe()}if(u&1&&S.value!==a[0]&&ge(S,a[0]),(!J||u&4)&&z!==(z=a[2].size+"")&&x(W,z),u&4){H=K(a[2].entries());let r;for(r=0;r<H.length;r+=1){const k=Ie(a,H,r);v[r]?(v[r].p(k,u),N(v[r],1)):(v[r]=Se(k),v[r].c(),N(v[r],1),v[r].m(B,null))}for(Ee(),r=H.length;r<v.length;r+=1)Re(r);pe()}},i(a){if(!J){N(t.$$.fragment,a);for(let u=0;u<C.length;u+=1)N(m[u]);for(let u=0;u<H.length;u+=1)N(v[u]);J=!0}},o(a){D(t.$$.fragment,a),m=m.filter(Boolean);for(let u=0;u<m.length;u+=1)D(m[u]);v=v.filter(Boolean);for(let u=0;u<v.length;u+=1)D(v[u]);J=!1},d(a){a&&(_(s),_(e)),fe(t,a),be(m,a),l[5](null),be(v,a),te=!1,ye(he)}}}function ze(l){l.scroll({top:l.scrollHeight,behavior:"smooth"})}function Je(l,t,s){let e,o;le(l,A,c=>s(7,e=c)),le(l,ae,c=>s(8,o=c));let n="",j=null,I=[],d=[{username:"frensgo",body:`Bienvenido a la sala ${o.room}`}];Oe(()=>{e.send(JSON.stringify({type:"GETUSERLIST"}))});function p(){P(A,e=new WebSocket(`wss://frensgo.onrender.com/ws/${o.room}/${o.username}`),e),P(A,e.onmessage=c=>{const{type:g,msg:R}=JSON.parse(c.data);h(g,R)},e),P(A,e.onclose=c=>{setTimeout(p,3e3)},e)}function h(c,g){switch(c){case"USERLIST":const R=new Map(g);s(2,I=R);break;case"NEW_USER":console.log(g);break;case"BYE_USER":console.log(g);break;case"ROOM_MSG":d.push(g),s(3,d),d.length>=30&&(d.shift(),s(3,d)),setTimeout(()=>ze(j),.1)}}P(A,e.onmessage=c=>{const{type:g,msg:R}=JSON.parse(c.data);h(g,R)},e),P(A,e.onclose=c=>{setTimeout(p,3e3)},e);function T(){!n||n.length===0||n.length>120||(e.send(JSON.stringify({type:"ROOM_MSG",msg:n.trim()})),s(0,n=""))}function S(c){we[c?"unshift":"push"](()=>{j=c,s(1,j)})}function y(){n=this.value,s(0,n)}return[n,j,I,d,T,S,y]}class Ye extends re{constructor(t){super(),oe(this,t,Je,Ve,ne,{})}}export{Ye as component,Fe as universal};
