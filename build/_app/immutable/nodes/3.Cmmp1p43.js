import{m as pe,s as K,r as Le,d as ne,u as Ne}from"../chunks/index.BVeuErP0.js";import{s as re,y as G,n as X,c as J,o as Be,z as ke,d as Q,r as Ae,f as He}from"../chunks/scheduler.B2IlTnna.js";import{S as oe,i as ce,e as b,s as w,t as F,c as E,a as z,f as C,b as W,d as v,n as m,g as j,h as f,j as Z,y as ie,z as ue,m as ye,A as fe,p as Te,o as Ie,q as De,k as M,l as L,u as _e,B as me,C as ze,w as ge}from"../chunks/index.CH0HSZbu.js";import{N as Ve}from"../chunks/Navbar.CD5yEolB.js";import{g as je}from"../chunks/entry.ofO2gSjP.js";function ae(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function xe(){let l,e;if(pe.subscribe(s=>l=s),K.subscribe(s=>e=s),!l||!e)throw Le(307,"/")}const rt=Object.freeze(Object.defineProperty({__proto__:null,load:xe},Symbol.toStringTag,{value:"Module"}));function qe(l){let e;return{c(){e=b("i"),this.h()},l(s){e=E(s,"I",{class:!0}),z(e).forEach(v),this.h()},h(){m(e,"class","fa-solid fa-circle-user svelte-1hfc06y")},m(s,t){j(s,e,t)},d(s){s&&v(e)}}}function Pe(l){let e,s,t,n,r=decodeURI(l[0].username)+"",c,y,d,_,h=l[0].body+"",S,U,q,T=l[0].type!==l[2].BOT&&qe();return{c(){e=b("article"),s=b("div"),T&&T.c(),t=w(),n=b("h4"),c=F(r),y=w(),d=b("div"),_=b("p"),S=F(h),this.h()},l(i){e=E(i,"ARTICLE",{class:!0});var I=z(e);s=E(I,"DIV",{class:!0});var B=z(s);T&&T.l(B),t=C(B),n=E(B,"H4",{class:!0});var R=z(n);c=W(R,r),R.forEach(v),B.forEach(v),y=C(I),d=E(I,"DIV",{class:!0});var k=z(d);_=E(k,"P",{class:!0});var x=z(_);S=W(x,h),x.forEach(v),k.forEach(v),I.forEach(v),this.h()},h(){m(n,"class","montserrat-alternates-bold svelte-1hfc06y"),m(s,"class","username svelte-1hfc06y"),m(_,"class","montserrat-alternates-regular"),m(d,"class",U=G(`body ${l[0].type===l[2].BOT?"typeBot":""}`)+" svelte-1hfc06y"),m(e,"class",q=G(l[1].username===decodeURI(l[0].username)?"me":"")+" svelte-1hfc06y")},m(i,I){j(i,e,I),f(e,s),T&&T.m(s,null),f(s,t),f(s,n),f(n,c),f(e,y),f(e,d),f(d,_),f(_,S)},p(i,[I]){i[0].type!==i[2].BOT?T||(T=qe(),T.c(),T.m(s,t)):T&&(T.d(1),T=null),I&1&&r!==(r=decodeURI(i[0].username)+"")&&Z(c,r),I&1&&h!==(h=i[0].body+"")&&Z(S,h),I&1&&U!==(U=G(`body ${i[0].type===i[2].BOT?"typeBot":""}`)+" svelte-1hfc06y")&&m(d,"class",U),I&3&&q!==(q=G(i[1].username===decodeURI(i[0].username)?"me":"")+" svelte-1hfc06y")&&m(e,"class",q)},i:X,o:X,d(i){i&&v(e),T&&T.d()}}}function Ge(l,e,s){let t;J(l,pe,c=>s(1,t=c));var n=(c=>(c.ROOM="room",c.BOT="bot",c))(n||{});let{data:r}=e;return l.$$set=c=>{"data"in c&&s(0,r=c.data)},[r,t,n]}class Je extends oe{constructor(e){super(),ce(this,e,Ge,Pe,re,{data:0})}}function Xe(l){let e,s,t,n,r=decodeURI(l[1].username)+"",c,y,d;return{c(){e=b("article"),s=b("i"),t=w(),n=b("h4"),c=F(r),y=w(),d=b("i"),this.h()},l(_){e=E(_,"ARTICLE",{"data-id":!0,class:!0});var h=z(e);s=E(h,"I",{class:!0}),z(s).forEach(v),t=C(h),n=E(h,"H4",{class:!0});var S=z(n);c=W(S,r),S.forEach(v),y=C(h),d=E(h,"I",{class:!0}),z(d).forEach(v),h.forEach(v),this.h()},h(){m(s,"class","fa-solid fa-circle-user svelte-vv2xs7"),m(n,"class","montserrat-alternates-bold svelte-vv2xs7"),m(d,"class","fa-solid fa-circle-question svelte-vv2xs7"),m(e,"data-id",l[0]),m(e,"class","svelte-vv2xs7")},m(_,h){j(_,e,h),f(e,s),f(e,t),f(e,n),f(n,c),f(e,y),f(e,d)},p(_,[h]){h&2&&r!==(r=decodeURI(_[1].username)+"")&&Z(c,r),h&1&&m(e,"data-id",_[0])},i:X,o:X,d(_){_&&v(e)}}}function Fe(l,e,s){let{id:t}=e,{data:n}=e;return l.$$set=r=>{"id"in r&&s(0,t=r.id),"data"in r&&s(1,n=r.data)},[t,n]}class We extends oe{constructor(e){super(),ce(this,e,Fe,Xe,re,{id:0,data:1})}}function Ye(l){let e,s,t,n;return{c(){e=b("section"),s=b("article"),t=b("h4"),n=F(l[0]),this.h()},l(r){e=E(r,"SECTION",{class:!0});var c=z(e);s=E(c,"ARTICLE",{class:!0});var y=z(s);t=E(y,"H4",{class:!0});var d=z(t);n=W(d,l[0]),d.forEach(v),y.forEach(v),c.forEach(v),this.h()},h(){m(t,"class","montserrat-alternates-medium svelte-1b74fp1"),m(s,"class","svelte-1b74fp1"),m(e,"class","svelte-1b74fp1")},m(r,c){j(r,e,c),f(e,s),f(s,t),f(t,n)},p(r,[c]){c&1&&Z(n,r[0])},i:X,o:X,d(r){r&&v(e)}}}function Ke(l,e,s){let t;J(l,ne,c=>s(2,t=c));let{msg:n}=e,{time:r}=e;return Be(()=>{document.onkeydown=()=>!1}),ke(()=>{document.onkeydown=null}),setTimeout(()=>Q(ne,t=!1,t),r),l.$$set=c=>{"msg"in c&&s(0,n=c.msg),"time"in c&&s(1,r=c.time)},[n,r]}class Qe extends oe{constructor(e){super(),ce(this,e,Ke,Ye,re,{msg:0,time:1})}}function Oe(l,e,s){const t=l.slice();return t[13]=e[s][0],t[14]=e[s][1],t}function Ue(l,e,s){const t=l.slice();return t[17]=e[s],t}function Re(l){let e,s;return e=new Qe({props:{msg:"Aver si nos calmamos un poquito :)",time:5e3}}),{c(){ie(e.$$.fragment)},l(t){ue(e.$$.fragment,t)},m(t,n){fe(e,t,n),s=!0},i(t){s||(M(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){me(e,t)}}}function Se(l){let e,s;return e=new Je({props:{data:l[17]}}),{c(){ie(e.$$.fragment)},l(t){ue(e.$$.fragment,t)},m(t,n){fe(e,t,n),s=!0},p(t,n){const r={};n&8&&(r.data=t[17]),e.$set(r)},i(t){s||(M(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){me(e,t)}}}function Me(l){let e,s;return e=new We({props:{id:l[13],data:l[14]}}),{c(){ie(e.$$.fragment)},l(t){ue(e.$$.fragment,t)},m(t,n){fe(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.id=t[13]),n&4&&(r.data=t[14]),e.$set(r)},i(t){s||(M(e.$$.fragment,t),s=!0)},o(t){L(e.$$.fragment,t),s=!1},d(t){me(e,t)}}}function Ze(l){let e,s,t,n,r,c,y,d,_,h='<div class="txtStyle svelte-v6z2xq"><button class="montserrat-alternates-regular activeStyle svelte-v6z2xq">T</button> <button class="montserrat-alternates-medium svelte-v6z2xq">T</button> <button class="montserrat-alternates-bold svelte-v6z2xq">T</button></div>',S,U,q,T,i,I='<i class="fa-solid fa-paper-plane svelte-v6z2xq"></i>',B,R,k,x,Y=l[2].size+"",$,he,A,ee,P,de,be,O=l[4]&&Re();s=new Ve({});let H=ae(l[3]),g=[];for(let a=0;a<H.length;a+=1)g[a]=Se(Ue(l,H,a));const we=a=>L(g[a],1,1,()=>{g[a]=null});let D=ae(l[2].entries()),p=[];for(let a=0;a<D.length;a+=1)p[a]=Me(Oe(l,D,a));const Ce=a=>L(p[a],1,1,()=>{p[a]=null});return{c(){O&&O.c(),e=w(),ie(s.$$.fragment),t=w(),n=b("section"),r=b("article"),c=b("div");for(let a=0;a<g.length;a+=1)g[a].c();y=w(),d=b("div"),_=b("div"),_.innerHTML=h,S=w(),U=b("form"),q=b("input"),T=w(),i=b("button"),i.innerHTML=I,B=w(),R=b("article"),k=b("h3"),x=F("Usuarios conectados: "),$=F(Y),he=w(),A=b("div");for(let a=0;a<p.length;a+=1)p[a].c();this.h()},l(a){O&&O.l(a),e=C(a),ue(s.$$.fragment,a),t=C(a),n=E(a,"SECTION",{class:!0});var u=z(n);r=E(u,"ARTICLE",{class:!0});var o=z(r);c=E(o,"DIV",{class:!0});var N=z(c);for(let V=0;V<g.length;V+=1)g[V].l(N);N.forEach(v),y=C(o),d=E(o,"DIV",{class:!0});var te=z(d);_=E(te,"DIV",{class:!0,"data-svelte-h":!0}),ye(_)!=="svelte-1vhb3g2"&&(_.innerHTML=h),S=C(te),U=E(te,"FORM",{class:!0});var se=z(U);q=E(se,"INPUT",{class:!0,type:!0,placeholder:!0,maxlength:!0,minlength:!0}),T=C(se),i=E(se,"BUTTON",{class:!0,"data-svelte-h":!0}),ye(i)!=="svelte-1m1u804"&&(i.innerHTML=I),se.forEach(v),te.forEach(v),o.forEach(v),B=C(u),R=E(u,"ARTICLE",{class:!0});var le=z(R);k=E(le,"H3",{class:!0});var ve=z(k);x=W(ve,"Usuarios conectados: "),$=W(ve,Y),ve.forEach(v),he=C(le),A=E(le,"DIV",{class:!0});var Ee=z(A);for(let V=0;V<p.length;V+=1)p[V].l(Ee);Ee.forEach(v),le.forEach(v),u.forEach(v),this.h()},h(){m(c,"class","chat svelte-v6z2xq"),m(_,"class","tools svelte-v6z2xq"),m(q,"class","montserrat-alternates-regular svelte-v6z2xq"),m(q,"type","text"),m(q,"placeholder","Escribe tu mensaje..."),m(q,"maxlength","120"),m(q,"minlength","1"),m(i,"class","svelte-v6z2xq"),m(U,"class","svelte-v6z2xq"),m(d,"class","msg svelte-v6z2xq"),m(r,"class","chatBX svelte-v6z2xq"),m(k,"class","montserrat-alternates-bold svelte-v6z2xq"),m(A,"class","userlist svelte-v6z2xq"),m(R,"class",ee=G(`users ${l[5]?"showUserlist":""}`)+" svelte-v6z2xq"),m(n,"class","svelte-v6z2xq")},m(a,u){O&&O.m(a,u),j(a,e,u),fe(s,a,u),j(a,t,u),j(a,n,u),f(n,r),f(r,c);for(let o=0;o<g.length;o+=1)g[o]&&g[o].m(c,null);l[7](c),f(r,y),f(r,d),f(d,_),f(d,S),f(d,U),f(U,q),Te(q,l[0]),f(U,T),f(U,i),f(n,B),f(n,R),f(R,k),f(k,x),f(k,$),f(R,he),f(R,A);for(let o=0;o<p.length;o+=1)p[o]&&p[o].m(A,null);P=!0,de||(be=[Ie(q,"input",l[8]),Ie(U,"submit",De(l[6]))],de=!0)},p(a,[u]){if(a[4]?O?u&16&&M(O,1):(O=Re(),O.c(),M(O,1),O.m(e.parentNode,e)):O&&(ge(),L(O,1,1,()=>{O=null}),_e()),u&8){H=ae(a[3]);let o;for(o=0;o<H.length;o+=1){const N=Ue(a,H,o);g[o]?(g[o].p(N,u),M(g[o],1)):(g[o]=Se(N),g[o].c(),M(g[o],1),g[o].m(c,null))}for(ge(),o=H.length;o<g.length;o+=1)we(o);_e()}if(u&1&&q.value!==a[0]&&Te(q,a[0]),(!P||u&4)&&Y!==(Y=a[2].size+"")&&Z($,Y),u&4){D=ae(a[2].entries());let o;for(o=0;o<D.length;o+=1){const N=Oe(a,D,o);p[o]?(p[o].p(N,u),M(p[o],1)):(p[o]=Me(N),p[o].c(),M(p[o],1),p[o].m(A,null))}for(ge(),o=D.length;o<p.length;o+=1)Ce(o);_e()}(!P||u&32&&ee!==(ee=G(`users ${a[5]?"showUserlist":""}`)+" svelte-v6z2xq"))&&m(R,"class",ee)},i(a){if(!P){M(O),M(s.$$.fragment,a);for(let u=0;u<H.length;u+=1)M(g[u]);for(let u=0;u<D.length;u+=1)M(p[u]);P=!0}},o(a){L(O),L(s.$$.fragment,a),g=g.filter(Boolean);for(let u=0;u<g.length;u+=1)L(g[u]);p=p.filter(Boolean);for(let u=0;u<p.length;u+=1)L(p[u]);P=!1},d(a){a&&(v(e),v(t),v(n)),O&&O.d(a),me(s,a),ze(g,a),l[7](null),ze(p,a),de=!1,Ae(be)}}}function $e(l){l.scroll({top:l.scrollHeight,behavior:"smooth"})}function et(l,e,s){let t,n,r,c;J(l,K,i=>s(9,t=i)),J(l,ne,i=>s(4,n=i)),J(l,pe,i=>s(10,r=i)),J(l,Ne,i=>s(5,c=i));let y="",d=null,_=[],h=[{username:"frensgo :",body:`Bienvenido a la sala ${r.room}`,type:"bot"}];Be(()=>{t.send(JSON.stringify({type:"GETUSERLIST"}))}),ke(()=>{t.close(),Q(K,t=null,t)});function S(i,I){switch(i){case"USERLIST":const B=new Map(I);s(2,_=B);break;case"NEW_USER":const R={username:"frensgo :",body:I,type:"bot"};h.push(R),s(3,h);break;case"BYE_USER":const k={username:"frensgo :",body:I,type:"bot"};h.push(k),s(3,h);break;case"ROOM_MSG":h.push(I),s(3,h),h.length>=30&&(h.shift(),s(3,h)),setTimeout(()=>$e(d),.1);break;case"CALM":Q(ne,n=!0,n)}}Q(K,t.onmessage=i=>{const{type:I,msg:B}=JSON.parse(i.data);S(I,B)},t),Q(K,t.onclose=()=>{je("/rooms")},t);function U(){!y||y.length===0||y.length>120||(t.send(JSON.stringify({type:"ROOM_MSG",msg:y.trim()})),s(0,y=""))}function q(i){He[i?"unshift":"push"](()=>{d=i,s(1,d)})}function T(){y=this.value,s(0,y)}return[y,d,_,h,n,c,U,q,T]}class ot extends oe{constructor(e){super(),ce(this,e,et,Ze,re,{})}}export{ot as component,rt as universal};
