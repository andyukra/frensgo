import{m as ae,s as P,r as we}from"../chunks/index.CyBJct7Q.js";import{s as ne,y as me,n as K,c as le,r as Me,o as ye,d as se,f as Oe}from"../chunks/scheduler.Hg06gspx.js";import{S as re,i as oe,e as _,s as O,t as q,c as p,a as U,d as g,f as L,b as G,n as f,g as Q,h as c,j as Z,y as ce,z as ie,m as ve,A as ue,o as ge,p as _e,q as Le,k,u as pe,l as A,B as fe,C as be,w as Ee}from"../chunks/index.D1W0QcSA.js";import{N as ke}from"../chunks/Navbar.Dtb_VjD0.js";import"../chunks/entry.Cien_7da.js";function Y(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Be(){let l,e;if(ae.subscribe(s=>l=s),P.subscribe(s=>e=s),!l||!e)throw we(307,"/")}const Fe=Object.freeze(Object.defineProperty({__proto__:null,load:Be},Symbol.toStringTag,{value:"Module"}));function Ce(l){let e,s,t,o,n,j=decodeURI(l[0].username)+"",b,h,E,d,I=l[0].body+"",S,M;return{c(){e=_("article"),s=_("div"),t=_("i"),o=O(),n=_("h4"),b=q(j),h=O(),E=_("div"),d=_("p"),S=q(I),this.h()},l(u){e=p(u,"ARTICLE",{class:!0});var T=U(e);s=p(T,"DIV",{class:!0});var R=U(s);t=p(R,"I",{class:!0}),U(t).forEach(g),o=L(R),n=p(R,"H4",{class:!0});var w=U(n);b=G(w,j),w.forEach(g),R.forEach(g),h=L(T),E=p(T,"DIV",{class:!0});var y=U(E);d=p(y,"P",{class:!0});var D=U(d);S=G(D,I),D.forEach(g),y.forEach(g),T.forEach(g),this.h()},h(){f(t,"class","fa-solid fa-circle-user svelte-134al0i"),f(n,"class","montserrat-alternates-bold svelte-134al0i"),f(s,"class","username svelte-134al0i"),f(d,"class","montserrat-alternates-regular"),f(E,"class","body svelte-134al0i"),f(e,"class",M=me(l[1].username===decodeURI(l[0].username)?"me":"")+" svelte-134al0i")},m(u,T){Q(u,e,T),c(e,s),c(s,t),c(s,o),c(s,n),c(n,b),c(e,h),c(e,E),c(E,d),c(d,S)},p(u,[T]){T&1&&j!==(j=decodeURI(u[0].username)+"")&&Z(b,j),T&1&&I!==(I=u[0].body+"")&&Z(S,I),T&3&&M!==(M=me(u[1].username===decodeURI(u[0].username)?"me":"")+" svelte-134al0i")&&f(e,"class",M)},i:K,o:K,d(u){u&&g(e)}}}function Ne(l,e,s){let t;le(l,ae,n=>s(1,t=n));let{data:o}=e;return l.$$set=n=>{"data"in n&&s(0,o=n.data)},[o,t]}class He extends re{constructor(e){super(),oe(this,e,Ne,Ce,ne,{data:0})}}function $e(l){let e,s,t,o,n=decodeURI(l[1].username)+"",j,b,h;return{c(){e=_("article"),s=_("i"),t=O(),o=_("h4"),j=q(n),b=O(),h=_("i"),this.h()},l(E){e=p(E,"ARTICLE",{"data-id":!0,class:!0});var d=U(e);s=p(d,"I",{class:!0}),U(s).forEach(g),t=L(d),o=p(d,"H4",{class:!0});var I=U(o);j=G(I,n),I.forEach(g),b=L(d),h=p(d,"I",{class:!0}),U(h).forEach(g),d.forEach(g),this.h()},h(){f(s,"class","fa-solid fa-circle-user svelte-vv2xs7"),f(o,"class","montserrat-alternates-bold svelte-vv2xs7"),f(h,"class","fa-solid fa-circle-question svelte-vv2xs7"),f(e,"data-id",l[0]),f(e,"class","svelte-vv2xs7")},m(E,d){Q(E,e,d),c(e,s),c(e,t),c(e,o),c(o,j),c(e,b),c(e,h)},p(E,[d]){d&2&&n!==(n=decodeURI(E[1].username)+"")&&Z(j,n),d&1&&f(e,"data-id",E[0])},i:K,o:K,d(E){E&&g(e)}}}function Ae(l,e,s){let{id:t}=e,{data:o}=e;return l.$$set=n=>{"id"in n&&s(0,t=n.id),"data"in n&&s(1,o=n.data)},[t,o]}class De extends re{constructor(e){super(),oe(this,e,Ae,$e,ne,{id:0,data:1})}}function Ie(l,e,s){const t=l.slice();return t[11]=e[s][0],t[12]=e[s][1],t}function Te(l,e,s){const t=l.slice();return t[15]=e[s],t}function je(l){let e,s;return e=new He({props:{data:l[15]}}),{c(){ce(e.$$.fragment)},l(t){ie(e.$$.fragment,t)},m(t,o){ue(e,t,o),s=!0},p(t,o){const n={};o&8&&(n.data=t[15]),e.$set(n)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){A(e.$$.fragment,t),s=!1},d(t){fe(e,t)}}}function Se(l){let e,s;return e=new De({props:{id:l[11],data:l[12]}}),{c(){ce(e.$$.fragment)},l(t){ie(e.$$.fragment,t)},m(t,o){ue(e,t,o),s=!0},p(t,o){const n={};o&4&&(n.id=t[11]),o&4&&(n.data=t[12]),e.$set(n)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){A(e.$$.fragment,t),s=!1},d(t){fe(e,t)}}}function Ve(l){let e,s,t,o,n,j,b,h,E='<div class="txtStyle svelte-ghgvcj"><button class="montserrat-alternates-regular activeStyle svelte-ghgvcj">T</button> <button class="montserrat-alternates-medium svelte-ghgvcj">T</button> <button class="montserrat-alternates-bold svelte-ghgvcj">T</button></div>',d,I,S,M,u,T='<i class="fa-solid fa-paper-plane svelte-ghgvcj"></i>',R,w,y,D,V=l[2].size+"",J,x,C,z,ee,he;e=new ke({});let N=Y(l[3]),m=[];for(let a=0;a<N.length;a+=1)m[a]=je(Te(l,N,a));const Ue=a=>A(m[a],1,1,()=>{m[a]=null});let H=Y(l[2].entries()),v=[];for(let a=0;a<H.length;a+=1)v[a]=Se(Ie(l,H,a));const Re=a=>A(v[a],1,1,()=>{v[a]=null});return{c(){ce(e.$$.fragment),s=O(),t=_("section"),o=_("article"),n=_("div");for(let a=0;a<m.length;a+=1)m[a].c();j=O(),b=_("div"),h=_("div"),h.innerHTML=E,d=O(),I=_("form"),S=_("input"),M=O(),u=_("button"),u.innerHTML=T,R=O(),w=_("article"),y=_("h3"),D=q("Usuarios conectados: "),J=q(V),x=O(),C=_("div");for(let a=0;a<v.length;a+=1)v[a].c();this.h()},l(a){ie(e.$$.fragment,a),s=L(a),t=p(a,"SECTION",{class:!0});var i=U(t);o=p(i,"ARTICLE",{class:!0});var r=U(o);n=p(r,"DIV",{class:!0});var B=U(n);for(let $=0;$<m.length;$+=1)m[$].l(B);B.forEach(g),j=L(r),b=p(r,"DIV",{class:!0});var W=U(b);h=p(W,"DIV",{class:!0,"data-svelte-h":!0}),ve(h)!=="svelte-1vhb3g2"&&(h.innerHTML=E),d=L(W),I=p(W,"FORM",{class:!0});var X=U(I);S=p(X,"INPUT",{class:!0,type:!0,placeholder:!0,maxlength:!0,minlength:!0}),M=L(X),u=p(X,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(u)!=="svelte-1m1u804"&&(u.innerHTML=T),X.forEach(g),W.forEach(g),r.forEach(g),R=L(i),w=p(i,"ARTICLE",{class:!0});var F=U(w);y=p(F,"H3",{class:!0});var te=U(y);D=G(te,"Usuarios conectados: "),J=G(te,V),te.forEach(g),x=L(F),C=p(F,"DIV",{class:!0});var de=U(C);for(let $=0;$<v.length;$+=1)v[$].l(de);de.forEach(g),F.forEach(g),i.forEach(g),this.h()},h(){f(n,"class","chat svelte-ghgvcj"),f(h,"class","tools svelte-ghgvcj"),f(S,"class","montserrat-alternates-regular svelte-ghgvcj"),f(S,"type","text"),f(S,"placeholder","Escribe tu mensaje..."),f(S,"maxlength","120"),f(S,"minlength","1"),f(u,"class","svelte-ghgvcj"),f(I,"class","svelte-ghgvcj"),f(b,"class","msg svelte-ghgvcj"),f(o,"class","chatBX svelte-ghgvcj"),f(y,"class","montserrat-alternates-bold svelte-ghgvcj"),f(C,"class","userlist svelte-ghgvcj"),f(w,"class","users svelte-ghgvcj"),f(t,"class","svelte-ghgvcj")},m(a,i){ue(e,a,i),Q(a,s,i),Q(a,t,i),c(t,o),c(o,n);for(let r=0;r<m.length;r+=1)m[r]&&m[r].m(n,null);l[5](n),c(o,j),c(o,b),c(b,h),c(b,d),c(b,I),c(I,S),ge(S,l[0]),c(I,M),c(I,u),c(t,R),c(t,w),c(w,y),c(y,D),c(y,J),c(w,x),c(w,C);for(let r=0;r<v.length;r+=1)v[r]&&v[r].m(C,null);z=!0,ee||(he=[_e(S,"input",l[6]),_e(I,"submit",Le(l[4]))],ee=!0)},p(a,[i]){if(i&8){N=Y(a[3]);let r;for(r=0;r<N.length;r+=1){const B=Te(a,N,r);m[r]?(m[r].p(B,i),k(m[r],1)):(m[r]=je(B),m[r].c(),k(m[r],1),m[r].m(n,null))}for(Ee(),r=N.length;r<m.length;r+=1)Ue(r);pe()}if(i&1&&S.value!==a[0]&&ge(S,a[0]),(!z||i&4)&&V!==(V=a[2].size+"")&&Z(J,V),i&4){H=Y(a[2].entries());let r;for(r=0;r<H.length;r+=1){const B=Ie(a,H,r);v[r]?(v[r].p(B,i),k(v[r],1)):(v[r]=Se(B),v[r].c(),k(v[r],1),v[r].m(C,null))}for(Ee(),r=H.length;r<v.length;r+=1)Re(r);pe()}},i(a){if(!z){k(e.$$.fragment,a);for(let i=0;i<N.length;i+=1)k(m[i]);for(let i=0;i<H.length;i+=1)k(v[i]);z=!0}},o(a){A(e.$$.fragment,a),m=m.filter(Boolean);for(let i=0;i<m.length;i+=1)A(m[i]);v=v.filter(Boolean);for(let i=0;i<v.length;i+=1)A(v[i]);z=!1},d(a){a&&(g(s),g(t)),fe(e,a),be(m,a),l[5](null),be(v,a),ee=!1,Me(he)}}}function ze(l){l.scroll({top:l.scrollHeight,behavior:"smooth"})}function Pe(l,e,s){let t,o;le(l,P,u=>s(7,t=u)),le(l,ae,u=>s(8,o=u));let n="",j=null,b=[],h=[{username:"frensgo",body:`Bienvenido a la sala ${o.room}`}];ye(()=>{t.send(JSON.stringify({type:"GETUSERLIST"}))});function E(){se(P,t=new WebSocket(`wss://www.frensgo.lat/ws/${o.room}/${o.username}`),t)}function d(u,T){switch(u){case"USERLIST":const R=new Map(T);s(2,b=R);break;case"NEW_USER":console.log(T);break;case"BYE_USER":console.log(T);break;case"ROOM_MSG":h.push(T),s(3,h),h.length>=30&&(h.shift(),s(3,h)),setTimeout(()=>ze(j),.1)}}se(P,t.onmessage=u=>{const{type:T,msg:R}=JSON.parse(u.data);d(T,R)},t),se(P,t.onclose=u=>{setTimeout(E,3e3)},t);function I(){!n||n.length===0||n.length>120||(t.send(JSON.stringify({type:"ROOM_MSG",msg:n.trim()})),s(0,n=""))}function S(u){Oe[u?"unshift":"push"](()=>{j=u,s(1,j)})}function M(){n=this.value,s(0,n)}return[n,j,b,h,I,S,M]}class Ye extends re{constructor(e){super(),oe(this,e,Pe,Ve,ne,{})}}export{Ye as component,Fe as universal};
